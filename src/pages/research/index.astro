---
import PageLayout from "@layouts/PageLayout.astro";
import GlassCard from "@components/cards/GlassCard.astro";
import Badge from "@components/ui/Badge.astro";
import { getCollection } from "astro:content";

import BlurReveal from "@components/islands/BlurReveal";
import StaggerReveal from "@components/islands/StaggerReveal";

const papers = (await getCollection("research"))
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime());
---

<PageLayout title="Research" description="Papers and publications in computational chemistry and machine learning.">
  <section class="py-12">
    <BlurReveal
      client:idle
      text="Research"
      className="text-3xl font-heading font-medium text-text-primary mb-2 tracking-tight"
      as="h1"
    />
    <p
      class="text-text-muted mb-10"
      style="opacity: 0; animation: fade-up 0.5s ease-out 0.4s forwards;"
    >
      Papers and publications in computational chemistry, spectroscopy, and ML.
    </p>

    <StaggerReveal client:visible className="grid gap-4" stagger={0.1}>
      {
        papers.map((paper) => (
          <GlassCard href={`/research/${paper.id}`} class="group" padding="lg">
            <div class="flex items-start gap-3 mb-3">
              <Badge>{paper.data.status}</Badge>
              <span class="text-xs text-text-muted font-mono">
                {paper.data.venue}
              </span>
            </div>
            <h2 class="text-lg font-heading font-medium text-text-primary group-hover:text-accent transition-colors">
              {paper.data.title}
            </h2>
            <p class="mt-1 text-sm text-text-muted">
              {paper.data.authors.join(", ")}
            </p>
            <p class="mt-3 text-sm text-text-secondary line-clamp-3">
              {paper.data.abstract}
            </p>
            <div class="mt-4 flex gap-3">
              {paper.data.arxiv && (
                <a
                  href={paper.data.arxiv}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="text-xs text-text-secondary hover:text-text-primary transition-colors"
                  onclick="event.stopPropagation()"
                >
                  arXiv &rarr;
                </a>
              )}
              {paper.data.pdf && (
                <a
                  href={paper.data.pdf}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="text-xs text-text-secondary hover:text-text-primary transition-colors"
                  onclick="event.stopPropagation()"
                >
                  PDF &rarr;
                </a>
              )}
            </div>
          </GlassCard>
        ))
      }

      {papers.length === 0 && (
        <div class="card rounded-2xl p-12 text-center">
          <p class="text-text-muted">Research publications coming soon.</p>
        </div>
      )}
    </StaggerReveal>
  </section>
</PageLayout>
