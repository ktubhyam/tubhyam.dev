---
title: "Spectral Identifiability: Group-Theoretic Constraints on Vibrational Inversion"
date: 2026-02-15
description: "A formal treatment of spectral identifiability — when vibrational spectra uniquely determine molecular structure, what group theory says about the limits of inversion, and numerical evidence for generic identifiability."
tags: ["spectroscopy", "group-theory", "information-theory", "research"]
draft: false
---

import TerminalBlock from '@components/islands/TerminalBlock';
import SymmetryExplorer from '@components/islands/SymmetryExplorer';

In 1966, Mark Kac posed a question that became one of the most cited in spectral theory: *"Can one hear the shape of a drum?"* He wanted to know whether a drum's resonant frequencies uniquely determine its geometry. Gordon, Webb, and Wolpert answered **no** in 1992 — they constructed non-isometric planar domains with identical Dirichlet spectra.

The molecular version of this question is more interesting, because it has a more interesting answer.

## The Forward Problem

Every molecule is a mechanical system. Its atoms are masses connected by bonds, and the bonds resist deformation. The vibrational frequencies are the eigenvalues of the <span class="highlight">Wilson GF secular equation</span>:

$$\det(\mathbf{GF} - \lambda \mathbf{I}) = 0$$

**G** encodes the kinetic energy — atomic masses and their geometric arrangement. **F** encodes the potential energy — the Hessian of the Born-Oppenheimer surface evaluated at equilibrium. The eigenvalues give the squared normal mode frequencies. The eigenvectors determine what we can actually see.

The observables are intensities, not eigenvectors directly. IR spectroscopy measures the <span class="highlight-teal">squared derivative of the dipole moment</span> along each normal coordinate. Raman spectroscopy measures the <span class="highlight-violet">squared derivative of the polarizability tensor</span>. A mode is visible to a technique only if the relevant derivative is nonzero.

This forward map — from molecular structure to observed spectrum — is smooth, computable, and routinely evaluated by DFT codes. Going backwards is where things break.

<TerminalBlock
  client:visible
  title="dft_calculation.py"
  lines={[
    { spans: [{ text: "$ python dft_spectrum.py --method b3lyp --basis def2-tzvp", color: "muted" }] },
    { spans: [{ text: "" }], delay: 200 },
    { spans: [{ text: "Forward problem (structure → spectrum):", color: "teal" }] },
    { spans: [
      { text: "  Input:  ", color: "muted" },
      { text: "molecular geometry + force constants", color: "white" },
    ] },
    { spans: [
      { text: "  Output: ", color: "muted" },
      { text: "frequencies + IR intensities + Raman activities", color: "white" },
    ] },
    { spans: [
      { text: "  Status: ", color: "muted" },
      { text: "solved", color: "green" },
      { text: " (routine DFT calculation)", color: "muted" },
    ] },
    { spans: [{ text: "" }] },
    { spans: [{ text: "Inverse problem (spectrum → structure):", color: "amber" }] },
    { spans: [
      { text: "  Input:  ", color: "muted" },
      { text: "frequencies + intensities", color: "white" },
    ] },
    { spans: [
      { text: "  Output: ", color: "muted" },
      { text: "molecular geometry?", color: "white" },
    ] },
    { spans: [
      { text: "  Status: ", color: "muted" },
      { text: "ill-posed", color: "red" },
      { text: " (symmetry creates degeneracies)", color: "muted" },
    ] },
  ]}
/>

## Why Symmetry Creates Blind Spots

The selection rules for IR and Raman activity are determined entirely by the molecule's <span class="highlight">point group G</span>. Each irreducible representation of G carries specific transformation properties under the symmetry operations, and these properties dictate observability:

- A mode is **IR-active** if its irreducible representation has the same symmetry as a translation — meaning it transforms as x, y, or z under the point group operations
- A mode is **Raman-active** if it transforms as a quadratic form — xx, yy, zz, xy, xz, or yz
- A mode matching neither is <span class="highlight-violet">silent</span>: invisible to both techniques, its information permanently inaccessible

The <span class="highlight">Information Completeness Ratio</span> quantifies how much of the vibrational information survives:

$$R(G, N) = \frac{N_{\text{IR}} + N_{\text{Raman}}}{3N - 6}$$

This is computable directly from the character table. Decompose the reducible vibrational representation into irreducible components, check each component against the selection rules, count what's observable.

<div class="callout callout-theorem">
  <div class="callout-label">Theorem 1 — Symmetry Quotient + Information Completeness</div>

The vibrational forward map is **G-invariant**: it factors through the quotient space M/G. The inverse map recovers structure only up to symmetry equivalence. When R(G, N) = 1, all vibrational DOF are observable and the quotient map is potentially injective. When R < 1, the silent modes create a degenerate fiber of positive dimension — a family of distinct force constant matrices that produce identical spectra.

</div>

<div class="callout callout-theorem">
  <div class="callout-label">Theorem 2 — Modal Complementarity</div>

For centrosymmetric molecules (point group contains the inversion operation **i**), IR and Raman modes are **completely disjoint**. Gerade modes (symmetric under inversion) are Raman-only. Ungerade modes (antisymmetric) are IR-only. No mode is active in both. Combined measurement strictly increases observable DOF beyond what either technique alone provides.

</div>

The proof of Theorem 2 is direct: inversion maps dipole derivatives to their negatives (so only ungerade modes have nonzero IR intensity) and maps polarizability derivatives to themselves (so only gerade modes have nonzero Raman intensity). The sets are <span class="highlight-teal">disjoint by construction</span>.

## The Numbers: QM9 Analysis

The QM9 dataset — <span class="highlight">130,831 small organic molecules</span> with up to 9 heavy atoms — provides a comprehensive survey of symmetry in organic chemistry:

<TerminalBlock
  client:visible
  title="symmetry_analysis.py"
  lines={[
    { spans: [{ text: "$ python symmetry_analysis.py --dataset qm9 --n 130831", color: "muted" }] },
    { spans: [{ text: "" }], delay: 300 },
    { spans: [{ text: "Point group distribution (QM9, 130,831 molecules):", color: "teal" }] },
    { spans: [{ text: "" }] },
    { spans: [
      { text: "  C1  ", color: "white" },
      { text: "83,241", color: "amber" },
      { text: "  (63.6%)  R = 1.000", color: "muted" },
    ] },
    { spans: [
      { text: "  Cs  ", color: "white" },
      { text: "31,107", color: "amber" },
      { text: "  (23.8%)  R = 1.000", color: "muted" },
    ] },
    { spans: [
      { text: "  C2v ", color: "white" },
      { text: " 9,842", color: "amber" },
      { text: "  ( 7.5%)  R = 1.000", color: "muted" },
    ] },
    { spans: [
      { text: "  C2h ", color: "white" },
      { text: " 2,103", color: "amber" },
      { text: "  ( 1.6%)  R = 1.000", color: "muted" },
    ] },
    { spans: [
      { text: "  D3h ", color: "white" },
      { text: "   284", color: "amber" },
      { text: "  ( 0.2%)  R = 0.917", color: "red" },
    ] },
    { spans: [
      { text: "  Td  ", color: "white" },
      { text: "    38", color: "amber" },
      { text: "  ( 0.0%)  R = 0.778", color: "red" },
    ] },
    { spans: [
      { text: "  Oh  ", color: "white" },
      { text: "     5", color: "amber" },
      { text: "  ( 0.0%)  R = 0.452", color: "red" },
    ] },
    { spans: [{ text: "" }], delay: 200 },
    { spans: [
      { text: "  R = 1.0:  ", color: "muted" },
      { text: "99.9%", color: "green" },
      { text: " of molecules — all modes observable", color: "muted" },
    ] },
    { spans: [
      { text: "  R < 1.0:  ", color: "muted" },
      { text: " 0.1%", color: "red" },
      { text: " of molecules — silent modes present", color: "muted" },
    ] },
  ]}
/>

Explore different molecules to see how symmetry determines spectral observability — pick a molecule and see which modes are IR-active, Raman-active, or silent:

<SymmetryExplorer client:visible />

The distribution is heavily skewed. Most organic molecules have low symmetry (C₁ or Cs) — all modes are observable and R = 1. The high-symmetry cases (Td, Oh, D₆h) are rare in organic chemistry but common among important inorganic structures: methane, cubane, SF₆, buckminsterfullerene.

## Generic Identifiability

Knowing that R = 1 does not by itself prove that the inverse map is injective. Full information completeness means every mode is observable — but two different force constant matrices could in principle produce the same frequencies and intensities even when all modes are visible. The question is whether this actually happens.

<div class="callout callout-conjecture">
  <div class="callout-label">Conjecture 3 — Generic Identifiability</div>

The combined IR + Raman forward map is generically injective on the quotient space F/G. That is, for almost all molecular geometries (outside a set of measure zero), distinct force constant equivalence classes produce distinct combined spectra.

</div>

The standard approach to proving generic injectivity would be to show that the Jacobian of the forward map has full rank almost everywhere, then invoke Sard's theorem. The problem: the forward map's <span class="highlight-violet">smoothness breaks at eigenvalue degeneracies</span> (where two normal modes have the same frequency), so Sard's theorem cannot be directly applied.

What we can do is compute the Jacobian numerically. On 999 molecular geometries from QM9, the result is unambiguous:

<TerminalBlock
  client:visible
  title="jacobian_analysis.py"
  lines={[
    { spans: [{ text: "$ python jacobian_rank.py --dataset qm9 --n 999 --verbose", color: "muted" }] },
    { spans: [{ text: "" }], delay: 300 },
    { spans: [{ text: "Numerical Jacobian rank analysis:", color: "teal" }] },
    { spans: [{ text: "" }] },
    { spans: [
      { text: "  Molecules tested:     ", color: "muted" },
      { text: "999", color: "white" },
    ] },
    { spans: [
      { text: "  Full rank:            ", color: "muted" },
      { text: "999", color: "green" },
      { text: " (100%)", color: "muted" },
    ] },
    { spans: [
      { text: "  Rank deficient:       ", color: "muted" },
      { text: "0", color: "green" },
    ] },
    { spans: [{ text: "" }] },
    { spans: [{ text: "  Overdetermination ratio (observables / unknowns):", color: "muted" }] },
    { spans: [
      { text: "    min:  ", color: "muted" },
      { text: "2.8:1", color: "amber" },
    ] },
    { spans: [
      { text: "    mean: ", color: "muted" },
      { text: "4.2:1", color: "amber" },
    ] },
    { spans: [
      { text: "    max:  ", color: "muted" },
      { text: "6.1:1", color: "amber" },
    ] },
    { spans: [{ text: "" }], delay: 200 },
    { spans: [
      { text: "→ ", color: "muted" },
      { text: "No rank deficiency found at any tested geometry", color: "green" },
    ] },
  ]}
/>

<span class="highlight-teal">Full rank at every tested point, with a mean 4.2:1 overdetermination.</span> The system is not just barely solvable — it has substantial redundancy. This does not constitute a proof (999 points is a finite sample), but the margin makes accidental rank deficiency extremely unlikely.

## Predictions for Machine Learning

The theory generates three quantitative, testable predictions:

<div class="callout callout-result">
  <div class="callout-label">Prediction 1 — Accuracy Tracks R(G, N)</div>

Model accuracy on molecular identification should decrease monotonically with decreasing R(G, N). High-symmetry molecules with silent modes present a fundamentally harder inverse problem. No model — regardless of size or architecture — can recover information that was never in the spectrum.

</div>

<div class="callout callout-result">
  <div class="callout-label">Prediction 2 — Multimodal Gains on Centrosymmetric Molecules</div>

IR + Raman fusion should outperform unimodal models, with the **largest accuracy gains** on centrosymmetric molecules where Theorem 2 guarantees disjoint mode sets. For non-centrosymmetric molecules, the gain should be smaller (overlapping information).

</div>

**Prediction 3** concerns learning efficiency. The <span class="highlight">4.2:1 overdetermination ratio</span> suggests that the learning problem is well-conditioned: the information-theoretic capacity of combined spectra substantially exceeds the dimensionality of the force constant space. Models should not need massive overparameterization to achieve near-optimal inversion.

<TerminalBlock
  client:visible
  title="fano_bound.py"
  lines={[
    { spans: [{ text: "$ python fano_bound.py --dataset qm9 --modality combined", color: "muted" }] },
    { spans: [{ text: "" }], delay: 200 },
    { spans: [{ text: "Fano inequality analysis:", color: "teal" }] },
    { spans: [{ text: "" }] },
    { spans: [
      { text: "  Bound on minimum error probability P_e:", color: "muted" },
    ] },
    { spans: [{ text: "" }] },
    { spans: [
      { text: "  IR only:         ", color: "muted" },
      { text: "P_e ≥ 0.12", color: "red" },
    ] },
    { spans: [
      { text: "  Raman only:      ", color: "muted" },
      { text: "P_e ≥ 0.09", color: "amber" },
    ] },
    { spans: [
      { text: "  IR + Raman:      ", color: "muted" },
      { text: "P_e ≥ 0.00", color: "green" },
      { text: " (for R=1 molecules)", color: "muted" },
    ] },
    { spans: [{ text: "" }], delay: 150 },
    { spans: [
      { text: "→ ", color: "muted" },
      { text: "Perfect inversion theoretically achievable for R=1", color: "green" },
    ] },
  ]}
/>

The Fano inequality bounds the minimum error achievable by any estimator:

$$P_e \geq 1 - \frac{I(X;\, Y_{\text{IR}}, Y_{\text{Raman}}) + 1}{\log |\mathcal{X}|}$$

For molecules with R = 1 and generic identifiability, the mutual information saturates — the bound goes to zero. <span class="highlight-teal">Perfect inversion is not just possible, it is the information-theoretic limit.</span>

These predictions are being tested on QM9S (130K molecules with computed IR, Raman, and UV spectra at B3LYP/def2-TZVP). The model architecture is described in the [companion post on the spectral inverse problem](/blog/spectral-inverse-problem).

## Related

- **Companion post:** [The Spectral Inverse Problem](/blog/spectral-inverse-problem) — from group theory to foundation models
- **Research paper:** [Spectral Identifiability](/research/spectral-identifiability) — the formal paper with proofs and complete computational evidence
- **Research paper:** [Hybrid SSA Spectroscopy](/research/hybrid-ssa-spectroscopy) — the Spektron architecture motivated by this theory
- **Project:** [Spektron](/projects/spektron) — where these theoretical predictions are being empirically tested
- **SSM architecture:** [State Space Models for Spectroscopy](/blog/state-space-models-for-spectroscopy) — how SSMs capture the long-range correlations this theory predicts matter
