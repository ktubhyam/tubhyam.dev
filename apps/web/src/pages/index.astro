---
import BaseLayout from "@layouts/BaseLayout.astro";
import StarBorder from "@components/ui/StarBorder.astro";
import Badge from "@components/ui/Badge.astro";
import { SITE, PUBLICATION } from "@lib/constants";
import { getCollection } from "astro:content";
import { formatDate, readingTime } from "@lib/utils";

// Fetch latest blog posts
const posts = (await getCollection("blog"))
  .filter((post) => !post.data.draft)
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime());

const featuredPost = posts[0];
const recentPosts = posts.slice(1, 3);

// React island components
import SideNav from "@components/islands/SideNav";
import ScrollProgress from "@components/islands/ScrollProgress";
import FullPageScroller from "@components/islands/FullPageScroller";
import RotatingText from "@components/islands/RotatingText";
import DecryptedText from "@components/islands/DecryptedText";
import SpectrumViz from "@components/islands/SpectrumViz";
import MetricCards from "@components/islands/MetricCards";
import AvailabilityStatus from "@components/islands/AvailabilityStatus";
import TextScramble from "@components/islands/TextScramble";
import GradientText from "@components/islands/GradientText";
import AtomOrbit3D from "@components/islands/AtomOrbit3D";
import HeroSpectrum from "@components/islands/HeroSpectrum";
import InverseProblemFlow from "@components/islands/InverseProblemFlow";
import PipelineFlow from "@components/islands/PipelineFlow";
import SpotlightCard from "@components/islands/SpotlightCard";
import LogStream from "@components/islands/LogStream";
import MastHeadReveal from "@components/islands/MastHeadReveal";
import ContributionGrid from "@components/islands/ContributionGrid";
import VibeScopePreview from "@components/islands/VibeScopePreview";
import MoleculeCard from "@components/islands/MoleculeCard";
import OrbitalDiagram from "@components/islands/OrbitalDiagram";
import NavTerminalPath from "@components/islands/NavTerminalPath";
import SpectrumHero from "@components/islands/SpectrumHero";
import BentoMiniViz from "@components/islands/BentoMiniViz";
import NeuralLandscape from "@components/islands/NeuralLandscape";
import InverseSpectrumFlow from "@components/islands/InverseSpectrumFlow";
---

<BaseLayout title={SITE.title} hideNav>
  <script type="application/ld+json" set:html={JSON.stringify({
    "@context": "https://schema.org",
    "@type": "ProfilePage",
    "mainEntity": {
      "@type": "Person",
      "name": SITE.author,
      "url": SITE.url,
      "jobTitle": "Computational Chemist & ML Researcher",
      "description": SITE.description,
      "sameAs": [
        SITE.github,
        SITE.twitter,
        SITE.linkedin,
        "https://orcid.org/0009-0001-4424-7297",
        "https://scholar.google.com/citations?user=ktubhyam",
        "https://www.reddit.com/user/ktubhyam",
        "https://huggingface.co/ktubhyam",
        "https://pypi.org/user/ktubhyam/",
        "https://www.npmjs.com/~ktubhyam",
        "https://buttondown.com/latentchemistry",
      ],
      "knowsAbout": [
        "Vibrational Spectroscopy", "Deep Learning", "State Space Models",
        "Neural ODEs", "Molecular Modeling", "Information Theory",
        "Physics-Informed Machine Learning", "Chemical Engineering"
      ],
    },
  })} />

  <!-- Scroll infra islands (no DOM output) -->
  <ScrollProgress client:load />
  <FullPageScroller client:load />
  <SideNav client:idle />

  <!-- Fixed header with terminal pill -->
  <header class="fixed top-0 left-0 right-0 z-50 px-6 flex items-center justify-between" id="home-nav" style="height:48px; background: rgba(0,0,0,0.88); backdrop-filter: blur(20px) saturate(180%); -webkit-backdrop-filter: blur(20px) saturate(180%); border-bottom: 1px solid rgba(255,255,255,0.06);">
    <!-- Terminal pill -->
    <div class="terminal-pill-home flex items-center gap-2 px-3 py-1.5 rounded-md border border-border bg-surface flex-shrink-0">
      <NavTerminalPath client:load />
    </div>

    <nav class="hidden md:flex items-center gap-6">
      <a href="/research" class="nav-top-link">Research</a>
      <a href="/projects" class="nav-top-link">Projects</a>
      <a href="/blog" class="nav-top-link">Blog</a>
      <a href="/simulations" class="nav-top-link">Simulations</a>
      <a
        href={SITE.github}
        target="_blank"
        rel="noopener noreferrer"
        aria-label="GitHub"
        class="nav-top-link"
      >
        <svg viewBox="0 0 24 24" class="w-4 h-4" fill="currentColor">
          <path d="M12 2C6.477 2 2 6.477 2 12c0 4.42 2.865 8.17 6.839 9.49.5.092.682-.217.682-.482 0-.237-.009-.866-.013-1.7-2.782.604-3.369-1.34-3.369-1.34-.454-1.156-1.11-1.464-1.11-1.464-.908-.62.069-.608.069-.608 1.003.07 1.531 1.03 1.531 1.03.892 1.529 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.11-4.555-4.943 0-1.091.39-1.984 1.029-2.683-.103-.253-.446-1.27.098-2.647 0 0 .84-.269 2.75 1.025A9.578 9.578 0 0112 6.836c.85.004 1.705.115 2.504.337 1.909-1.294 2.747-1.025 2.747-1.025.546 1.377.203 2.394.1 2.647.64.699 1.028 1.592 1.028 2.683 0 3.842-2.339 4.687-4.566 4.935.359.309.678.919.678 1.852 0 1.336-.012 2.415-.012 2.743 0 .267.18.578.688.48C19.138 20.167 22 16.418 22 12c0-5.523-4.477-10-10-10z" />
        </svg>
      </a>
    </nav>
    <!-- Mobile hamburger -->
    <button class="md:hidden text-text-muted p-1" id="home-mobile-trigger" aria-label="Open menu">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
        <path d="M3 12h18M3 6h18M3 18h18" />
      </svg>
    </button>
  </header>

  <!-- Mobile menu overlay -->
  <div class="md:hidden fixed inset-0 z-40 hidden" id="home-mobile-menu">
    <div class="absolute inset-0 bg-black/90 backdrop-blur-sm" id="home-mobile-backdrop"></div>
    <div class="absolute top-16 right-4 left-4 bg-surface border border-border rounded-xl p-6 flex flex-col gap-4">
      <a href="/research" class="text-text-secondary hover:text-text-primary font-mono text-sm transition-colors">Research</a>
      <a href="/projects" class="text-text-secondary hover:text-text-primary font-mono text-sm transition-colors">Projects</a>
      <a href="/blog" class="text-text-secondary hover:text-text-primary font-mono text-sm transition-colors">Blog</a>
      <a href="/simulations" class="text-text-secondary hover:text-text-primary font-mono text-sm transition-colors">Simulations</a>
      <a href="/about" class="text-text-secondary hover:text-text-primary font-mono text-sm transition-colors">About</a>
    </div>
  </div>

  <!-- ══════════════════════════════════════════════════════
       FULL-PAGE SCROLLER CONTAINER
       ══════════════════════════════════════════════════════ -->
  <main class="full-page-scroller" id="main-scroller">

    <!-- ══════════════════════════════
         SECTION 0 — HERO
         ══════════════════════════════ -->
    <section
      aria-label="Hero"
      data-nav-section="hero"
      class="full-page-section"
    >
      <!-- Aurora-style ambient background -->
      <div class="aurora-bg" aria-hidden="true"></div>
      <!-- Live IR spectrum background -->
      <SpectrumHero client:load />

      <span class="section-number">00</span>

      <div class="relative z-10 mx-auto max-w-5xl w-full px-6 h-full grid grid-cols-1 lg:grid-cols-2 gap-8 items-center">
        <!-- Text column -->
        <div class="hero-content">
          <!-- Name: TextScramble decode on mount -->
          <h1
            class="text-[clamp(3.25rem,9vw,6.75rem)] font-extrabold tracking-[-0.05em] leading-[0.88] text-text-primary"
            style="opacity: 0; animation: fade-up 0.7s cubic-bezier(0.16,1,0.3,1) 0.1s forwards;"
          >
            <TextScramble client:load text="Tubhyam Karthikeyan" speed={25} mono={false} className="font-heading font-extrabold" />
          </h1>

          <!-- Rotating subtitle -->
          <div
            class="mt-6 h-7 overflow-hidden"
            style="opacity: 0; animation: fade-up 0.6s cubic-bezier(0.16,1,0.3,1) 0.3s forwards;"
          >
            <RotatingText
              client:load
              texts={[
                "Computational Chemist",
                "ML Researcher",
                "Open Source Builder",
                "ICT Mumbai '30",
              ]}
              rotationInterval={3000}
              staggerDuration={0.02}
              staggerFrom="first"
              mainClassName="text-base font-body font-light text-text-secondary tracking-tight"
              elementLevelClassName="text-text-secondary"
              transition={{ type: "spring", damping: 30, stiffness: 200 }}
              initial={{ y: "100%", opacity: 0 }}
              animate={{ y: 0, opacity: 1 }}
              exit={{ y: "-100%", opacity: 0 }}
            />
          </div>

          <!-- Tagline: GradientText flowing amber -->
          <p
            class="mt-5 text-base font-light max-w-sm leading-relaxed hidden sm:block"
            style="opacity: 0; animation: fade-up 0.6s cubic-bezier(0.16,1,0.3,1) 0.5s forwards;"
          >
            <GradientText client:load>Building neural networks that understand molecules.</GradientText>
          </p>

          <!-- CTA buttons -->
          <div
            class="mt-8 flex flex-col sm:flex-row items-start sm:items-center gap-3"
            style="opacity: 0; animation: fade-up 0.6s cubic-bezier(0.16,1,0.3,1) 0.7s forwards;"
          >
            <StarBorder as="a" href="#research-section" color="#C9A04A" speed="4s">
              View Research
            </StarBorder>
            <a
              href="#build-section"
              class="text-sm font-mono text-text-muted hover:text-text-secondary border border-border hover:border-border-hover px-5 py-2.5 rounded-sm transition-colors duration-200"
            >
              See Projects →
            </a>
          </div>

          <!-- Social icons -->
          <div
            class="mt-8 flex items-center gap-3"
            style="opacity: 0; animation: fade-up 0.6s cubic-bezier(0.16,1,0.3,1) 0.9s forwards;"
          >
            <a href={SITE.github} target="_blank" rel="noopener noreferrer" aria-label="GitHub" class="social-icon">
              <svg viewBox="0 0 24 24" class="w-[18px] h-[18px]" fill="currentColor">
                <path d="M12 2C6.477 2 2 6.477 2 12c0 4.42 2.865 8.17 6.839 9.49.5.092.682-.217.682-.482 0-.237-.009-.866-.013-1.7-2.782.604-3.369-1.34-3.369-1.34-.454-1.156-1.11-1.464-1.11-1.464-.908-.62.069-.608.069-.608 1.003.07 1.531 1.03 1.531 1.03.892 1.529 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.11-4.555-4.943 0-1.091.39-1.984 1.029-2.683-.103-.253-.446-1.27.098-2.647 0 0 .84-.269 2.75 1.025A9.578 9.578 0 0112 6.836c.85.004 1.705.115 2.504.337 1.909-1.294 2.747-1.025 2.747-1.025.546 1.377.203 2.394.1 2.647.64.699 1.028 1.592 1.028 2.683 0 3.842-2.339 4.687-4.566 4.935.359.309.678.919.678 1.852 0 1.336-.012 2.415-.012 2.743 0 .267.18.578.688.48C19.138 20.167 22 16.418 22 12c0-5.523-4.477-10-10-10z" />
              </svg>
            </a>
            <a href={SITE.twitter} target="_blank" rel="noopener noreferrer" aria-label="Twitter" class="social-icon">
              <svg viewBox="0 0 24 24" class="w-[18px] h-[18px]" fill="currentColor">
                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z" />
              </svg>
            </a>
            <a href={SITE.linkedin} target="_blank" rel="noopener noreferrer" aria-label="LinkedIn" class="social-icon">
              <svg viewBox="0 0 24 24" class="w-[18px] h-[18px]" fill="currentColor">
                <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z" />
              </svg>
            </a>
            <a href={`mailto:${SITE.email}`} aria-label="Email" class="social-icon">
              <svg viewBox="0 0 24 24" class="w-[18px] h-[18px]" fill="none" stroke="currentColor" stroke-width="1.5">
                <rect x="2" y="4" width="20" height="16" rx="2" />
                <path d="M22 7l-10 7L2 7" />
              </svg>
            </a>
          </div>
        </div>

        <!-- Right column: AtomOrbit3D (desktop only) -->
        <div
          class="hidden lg:flex items-center justify-center overflow-hidden"
          style="opacity: 0; animation: fade-up 0.8s cubic-bezier(0.16,1,0.3,1) 0.6s forwards;"
        >
          <AtomOrbit3D
            client:load
            nodes={[
              { label: "Inverse Problem",    icon: "M22 12h-4l-3 9L9 3l-3 9H2",                                                                                                                                                                             description: "Recovering molecular structure directly from vibrational spectra.",                           color: "#C9A04A" },
              { label: "State Space Models", icon: "M4 4v5h.582m15.356 2A8.001 8.001 0 0 0 4.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 0 1-15.357-2m15.357 2H15",                                                                                      description: "Mamba and S4D architectures for long-range spectral sequence modeling.",                     color: "#C9A04A" },
              { label: "Spectroscopy",       icon: "M12 3L2 21h20L12 3zm0 4l7.5 13h-15L12 7z",                                                                                                                                                              description: "IR and Raman selection rules, normal modes, and group-theoretic analysis.",                  color: "#C9A04A" },
              { label: "Graph Networks",     icon: "M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 0-6 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81A2.99 2.99 0 0 0 6 9a3 3 0 0 0 0 6c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65a3 3 0 0 0 6 0 3 3 0 0 0-3-3z", description: "Fragment-aware molecular graph encoders for structure-spectrum mapping.",                    color: "#888888" },
              { label: "Neural ODEs",        icon: "M12 6V4m0 2a2 2 0 1 0 0 4m0-4a2 2 0 1 1 0 4m-6 8a2 2 0 1 0 0-4m0 4a2 2 0 1 1 0-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 1 0 0-4m0 4a2 2 0 1 1 0-4m0 4v2m0-6V4",                                              description: "Continuous dynamics for reactor simulation — 1500× faster than numerical solvers.",           color: "#888888" },
              { label: "Quantum Chemistry",  icon: "M9 3h6m-6 0v6l-4 9a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1l-4-9V3",                                                                                                                                             description: "DFT ground truth: B3LYP/def2-TZVP across QM9S — 130K molecules.",                          color: "#888888" },
            ]}
          />
        </div>
      </div>

      <!-- Scroll chevron -->
      <div class="absolute bottom-[52px] left-1/2 -translate-x-1/2 scroll-chevron" aria-hidden="true">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="text-text-muted">
          <path d="M6 9l6 6 6-6" />
        </svg>
      </div>
      <!-- Stats marquee pinned to bottom of hero -->
      <div class="absolute bottom-0 left-0 right-0 overflow-hidden border-t border-white/[0.04]" style="height:32px;" aria-hidden="true">
        <div class="marquee-track">
          <span class="marquee-content">130K molecules &nbsp;·&nbsp; 699 tests &nbsp;·&nbsp; 97% coverage &nbsp;·&nbsp; v1.8.0 &nbsp;·&nbsp; Neural ODEs &nbsp;·&nbsp; B3LYP/def2-TZVP &nbsp;·&nbsp; Target R² 0.95 &nbsp;·&nbsp; QM9S dataset &nbsp;·&nbsp;</span>
          <span class="marquee-content" aria-hidden="true">130K molecules &nbsp;·&nbsp; 699 tests &nbsp;·&nbsp; 97% coverage &nbsp;·&nbsp; v1.8.0 &nbsp;·&nbsp; Neural ODEs &nbsp;·&nbsp; B3LYP/def2-TZVP &nbsp;·&nbsp; Target R² 0.95 &nbsp;·&nbsp; QM9S dataset &nbsp;·&nbsp;</span>
        </div>
      </div>
    </section>

    <!-- ══════════════════════════════
         SECTION 1 — RESEARCH
         ══════════════════════════════ -->
    <section
      id="research-section"
      aria-label="Research"
      data-nav-section="research"
      class="full-page-section"
    >
      <span class="section-number">01</span>

      <div class="relative z-10 mx-auto max-w-5xl w-full px-6 h-full flex flex-col justify-center">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-10 items-center">
          <!-- Text column -->
          <div>
            <p class="text-[10px] font-mono text-accent tracking-[0.2em] uppercase mb-4" data-type-label="01 / Research"></p>
            <h2 class="text-3xl sm:text-4xl font-heading font-bold text-text-primary tracking-tight leading-tight mb-4">
              Solving the Spectral<br />Inverse Problem
            </h2>
            <p class="text-sm text-text-secondary leading-relaxed mb-5">
              I'm building <span class="text-text-primary font-medium">Spektron</span> — an SSM+attention hybrid architecture — to recover molecular structure directly from vibrational spectra. Training on QM9S (130K molecules), targeting R²&nbsp;=&nbsp;0.95 across IR and Raman.
            </p>

            <!-- Spektron callout -->
            <a
              href="/projects/spektron"
              class="flex items-center gap-3 p-3 rounded-lg border border-accent/20 bg-accent/5 mb-6 hover:border-accent/40 hover:bg-accent/8 transition-all group"
            >
              <div class="flex-1 min-w-0">
                <div class="flex items-center gap-2 mb-0.5">
                  <span class="text-[10px] font-mono text-accent font-semibold">Spektron</span>
                  <span class="text-[9px] font-mono text-accent/50">v0.1.0</span>
                  <span class="text-[9px] font-mono text-text-muted ml-auto">SSM + attention</span>
                </div>
                <p class="text-[11px] font-mono text-text-muted truncate">~1M parameters · 5 architectures · QM9S training</p>
              </div>
              <span class="text-accent/60 group-hover:text-accent text-sm transition-colors flex-shrink-0">→</span>
            </a>

            <!-- Stats row -->
            <div class="flex items-center gap-5 mb-6">
              <div>
                <p class="text-xl font-heading font-bold text-accent">130K</p>
                <p class="text-[10px] font-mono text-text-muted uppercase tracking-wider">molecules</p>
              </div>
              <div class="w-px h-7 bg-border"></div>
              <div>
                <p class="text-xl font-heading font-bold text-text-primary">2</p>
                <p class="text-[10px] font-mono text-text-muted uppercase tracking-wider">papers WIP</p>
              </div>
              <div class="w-px h-7 bg-border"></div>
              <div>
                <p class="text-xl font-heading font-bold text-accent-2">0.95</p>
                <p class="text-[10px] font-mono text-text-muted uppercase tracking-wider">target R²</p>
              </div>
            </div>

            <!-- PipelineFlow below stats -->
            <PipelineFlow client:visible className="mb-5" />

            <a href="/research" class="inline-flex items-center gap-2 text-sm font-mono text-accent hover:text-text-primary transition-colors">
              View all research →
            </a>
          </div>

          <!-- Visual column: HeroSpectrum + InverseSpectrumFlow + NeuralLandscape -->
          <div class="flex flex-col gap-3">
            <div class="rounded-xl overflow-hidden border border-border bg-bg-secondary">
              <HeroSpectrum client:visible />
              <p class="pb-2 text-[9px] font-mono text-text-muted/40 text-center tracking-wider">
                IR spectrum — benzaldehyde · B3LYP/def2-TZVP
              </p>
            </div>
            <div class="rounded-xl overflow-hidden border border-border bg-bg-secondary p-1">
              <InverseSpectrumFlow client:visible />
            </div>
            <div class="rounded-xl overflow-hidden border border-border bg-bg-secondary" style="height:160px;">
              <NeuralLandscape client:visible className="w-full h-full" />
            </div>
          </div>
        </div>

        <!-- Floating tags -->
        <div class="mt-5 flex flex-wrap gap-2">
          {["spectroscopy", "state space models", "graph networks", "neural ODEs", "QM9S", "IR/Raman"].map((tag) => (
            <span class="text-[10px] font-mono text-text-muted border border-border rounded-full px-3 py-1 hover:border-border-hover transition-colors">
              {tag}
            </span>
          ))}
        </div>
      </div>
    </section>

    <!-- ══════════════════════════════
         SECTION 2 — BUILD
         ══════════════════════════════ -->
    <section
      id="build-section"
      aria-label="Projects"
      data-nav-section="build"
      class="full-page-section"
    >
      <span class="section-number">02</span>

      <div class="relative z-10 mx-auto max-w-5xl w-full px-6 h-full flex flex-col justify-center">
        <p class="text-[10px] font-mono text-accent tracking-[0.2em] uppercase mb-3" data-type-label="02 / Build"></p>
        <h2 class="text-3xl sm:text-4xl font-heading font-bold text-text-primary tracking-tight mb-6">
          Open-source tools for chemical science
        </h2>

        <!-- Bento grid — each card wrapped in SpotlightCard -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-4" id="bento-grid">
          <!-- SpectraKit — large (spans 2 cols) -->
          <SpotlightCard client:idle className="col-span-2 row-span-1 group">
            <a href="/projects/spectrakit" class="-m-6 p-5 flex flex-col min-h-full focus:outline-none">
              <div class="flex items-start justify-between mb-3">
                <div>
                  <p class="text-[9px] font-mono text-text-muted/30 mb-0.5 tracking-[0.15em]">001</p>
                  <p class="text-xs font-mono text-accent mb-1">v1.8.0</p>
                  <h3 class="text-base font-heading font-semibold text-text-primary">SpectraKit</h3>
                </div>
                <Badge variant="outline">stable</Badge>
              </div>
              <p class="text-xs text-text-muted leading-relaxed mb-4">
                Python library for vibrational spectroscopy preprocessing and analysis.
              </p>
              <div class="flex items-center gap-3 text-[10px] font-mono text-text-muted">
                <span class="flex items-center gap-1"><span class="w-1.5 h-1.5 rounded-full bg-[#34D399]"></span>699 tests</span>
                <span>97% coverage</span>
              </div>
              <p class="mt-2 text-[10px] font-mono text-text-muted/60">pip install spectrakit</p>
              <div class="mt-3 -mx-5 border-t border-border/40">
                <BentoMiniViz client:idle kind="spectrakit" />
              </div>
            </a>
          </SpotlightCard>

          <!-- Spektron -->
          <SpotlightCard client:idle className="group">
            <a href="/projects/spektron" class="-m-6 p-5 flex flex-col min-h-full focus:outline-none">
              <div class="mb-2">
                <p class="text-[9px] font-mono text-text-muted/30 mb-0.5 tracking-[0.15em]">002</p>
                <p class="text-xs font-mono text-text-muted mb-1">v0.1.0</p>
                <h3 class="text-sm font-heading font-semibold text-text-primary">Spektron</h3>
              </div>
              <p class="text-[11px] text-text-muted leading-relaxed mb-3">SSM+attention for IR/Raman prediction</p>
              <div class="flex items-center gap-1 text-[10px] font-mono">
                <span class="w-1.5 h-1.5 rounded-full bg-[#C9A04A]"></span>
                <span class="text-text-muted">building</span>
              </div>
              <div class="mt-3 -mx-5 border-t border-border/40">
                <BentoMiniViz client:idle kind="spektron" />
              </div>
            </a>
          </SpotlightCard>

          <!-- ReactorTwin -->
          <SpotlightCard client:idle className="group">
            <a href="/projects/reactortwin" class="-m-6 p-5 flex flex-col min-h-full focus:outline-none">
              <div class="mb-2">
                <p class="text-[9px] font-mono text-text-muted/30 mb-0.5 tracking-[0.15em]">003</p>
                <p class="text-xs font-mono text-text-muted mb-1">v1.0.0</p>
                <h3 class="text-sm font-heading font-semibold text-text-primary">ReactorTwin</h3>
              </div>
              <p class="text-[11px] text-text-muted leading-relaxed mb-3">Neural ODE surrogate — 1500× faster</p>
              <div class="flex items-center gap-1 text-[10px] font-mono">
                <span class="w-1.5 h-1.5 rounded-full bg-[#34D399]"></span>
                <span class="text-text-muted">stable</span>
              </div>
              <div class="mt-3 -mx-5 border-t border-border/40">
                <BentoMiniViz client:idle kind="reactortwin" />
              </div>
            </a>
          </SpotlightCard>

          <!-- SpectraView — spans 2 cols -->
          <SpotlightCard client:idle className="col-span-2 group">
            <a href="https://github.com/ktubhyam/spectraview" target="_blank" rel="noopener noreferrer" class="-m-6 p-5 flex flex-col min-h-full focus:outline-none">
              <div class="flex items-start justify-between mb-2">
                <div>
                  <p class="text-[9px] font-mono text-text-muted/30 mb-0.5 tracking-[0.15em]">004</p>
                  <p class="text-xs font-mono text-text-muted mb-1">v0.1.0</p>
                  <h3 class="text-sm font-heading font-semibold text-text-primary">SpectraView</h3>
                </div>
                <Badge variant="outline">beta</Badge>
              </div>
              <p class="text-[11px] text-text-muted leading-relaxed mb-3">TypeScript React library — 15 components, Canvas+SVG renderer for spectra</p>
              <div class="-mx-5 border-t border-border/40">
                <BentoMiniViz client:idle kind="spectraview" />
              </div>
            </a>
          </SpotlightCard>
        </div>

        <!-- MetricCards strip -->
        <MetricCards client:visible />

        <!-- LogStream: training log -->
        <div class="mt-4">
          <LogStream client:visible />
        </div>
      </div>
    </section>

    <!-- ══════════════════════════════
         SECTION 3 — EXPLORE
         ══════════════════════════════ -->
    <section
      aria-label="Simulations"
      data-nav-section="explore"
      class="full-page-section"
    >
      <span class="section-number">03</span>

      <div class="relative z-10 mx-auto max-w-5xl w-full px-6 h-full flex flex-col justify-center pt-20">
        <p class="text-[10px] font-mono text-accent tracking-[0.2em] uppercase mb-3" data-type-label="03 / Explore"></p>
        <h2 class="text-3xl sm:text-4xl font-heading font-bold text-text-primary tracking-tight mb-2">
          Interactive Chemistry Simulations
        </h2>
        <p class="text-sm text-text-secondary mb-5">Explore molecular physics in your browser.</p>

        <!-- 2-column layout: VibScope left (60%), 4 compact cards right (40%) -->
        <div class="grid grid-cols-1 lg:grid-cols-5 gap-4 flex-1 min-h-0">
          <!-- Left: VibScope featured -->
          <div class="lg:col-span-3 sim-card flex flex-col min-h-0">
            <div class="flex items-center gap-2 mb-3 flex-shrink-0">
              <Badge>Featured</Badge>
              <h3 class="text-sm font-heading font-semibold text-text-primary">VibScope</h3>
              <span class="text-[10px] font-mono text-text-muted ml-auto">17 molecules · 3D · 60fps</span>
            </div>
            <div class="flex-1 min-h-0 overflow-hidden">
              <VibeScopePreview client:visible />
            </div>
            <div class="mt-3 flex items-center justify-between flex-shrink-0">
              <p class="text-[10px] font-mono text-text-muted">Three.js + WebGL · GIF export</p>
              <a href="/simulations/vibescope" class="text-[10px] font-mono text-text-muted hover:text-accent transition-colors">
                Launch full app →
              </a>
            </div>
          </div>

          <!-- Right: 4 compact simulation cards -->
          <div class="lg:col-span-2 flex flex-col gap-3">
            <a href="/simulations/normal-mode-explorer" class="compact-sim-card group">
              <div class="flex items-center justify-between">
                <div>
                  <h4 class="text-xs font-heading font-semibold text-text-primary mb-0.5">Normal Mode Explorer</h4>
                  <p class="text-[10px] font-mono text-text-muted">45 molecules · 583 modes</p>
                </div>
                <span class="text-[10px] font-mono text-text-muted group-hover:text-accent transition-colors flex-shrink-0">Launch →</span>
              </div>
            </a>

            <a href="https://orbital.tubhyam.dev" target="_blank" rel="noopener noreferrer" class="compact-sim-card group">
              <div class="flex items-center justify-between">
                <div>
                  <h4 class="text-xs font-heading font-semibold text-text-primary mb-0.5">Orbital Architect</h4>
                  <p class="text-[10px] font-mono text-text-muted">Aufbau · Pauli · Hund's rules</p>
                </div>
                <span class="text-[10px] font-mono text-text-muted group-hover:text-accent transition-colors flex-shrink-0">Launch →</span>
              </div>
            </a>

            <a href="/simulations/symmetry-explorer" class="compact-sim-card group">
              <div class="flex items-center justify-between">
                <div>
                  <h4 class="text-xs font-heading font-semibold text-text-primary mb-0.5">Symmetry Explorer</h4>
                  <p class="text-[10px] font-mono text-text-muted">15 point groups · character tables</p>
                </div>
                <span class="text-[10px] font-mono text-text-muted group-hover:text-accent transition-colors flex-shrink-0">Launch →</span>
              </div>
            </a>

            <a href="/simulations/spectrum-to-structure" class="compact-sim-card group">
              <div class="flex items-center justify-between">
                <div>
                  <h4 class="text-xs font-heading font-semibold text-text-primary mb-0.5">Spectrum-to-Structure</h4>
                  <p class="text-[10px] font-mono text-text-muted">ML-powered structure prediction</p>
                </div>
                <span class="text-[10px] font-mono text-text-muted group-hover:text-accent transition-colors flex-shrink-0">Launch →</span>
              </div>
            </a>
          </div>
        </div>
      </div>
    </section>

    <!-- ══════════════════════════════
         SECTION 4 — WRITING
         ══════════════════════════════ -->
    <section
      aria-label="Writing"
      data-nav-section="writing"
      class="full-page-section"
    >
      <span class="section-number">04</span>

      <div class="relative z-10 mx-auto max-w-5xl w-full px-6 h-full flex flex-col justify-center">
        <p class="text-[10px] font-mono text-accent tracking-[0.2em] uppercase mb-3" data-type-label="04 / Writing"></p>

        <!-- Publication name -->
        <MastHeadReveal
          client:visible
          text="LATENT CHEMISTRY"
          className="text-5xl sm:text-6xl font-heading font-extralight text-text-primary tracking-[-0.02em] mb-2"
        />
        <p class="text-sm text-text-secondary mb-6">{PUBLICATION.tagline}</p>

        <!-- 2-column layout: blog posts left | ContributionGrid right -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 flex-1 min-h-0">
          <!-- Left: blog post cards -->
          <div class="flex flex-col">
            {featuredPost && (
              <a href={`/blog/${featuredPost.id}`} class="block mb-4 featured-post-card group">
                <div class="flex items-center gap-3 mb-2">
                  <Badge>Latest</Badge>
                  <span class="text-[10px] font-mono text-text-muted">
                    {formatDate(featuredPost.data.date)} · {readingTime(featuredPost.body ?? "")} min read
                  </span>
                </div>
                <h3 class="text-base sm:text-lg font-heading font-semibold text-text-primary leading-snug group-hover:text-accent transition-colors">
                  {featuredPost.data.title}
                </h3>
                <div class="mt-2 flex flex-wrap gap-1.5">
                  {featuredPost.data.tags.slice(0, 3).map((tag: string) => (
                    <span class="text-[10px] font-mono text-accent/60 bg-accent/5 rounded-full px-2 py-0.5">{tag}</span>
                  ))}
                </div>
              </a>
            )}

            {recentPosts.length > 0 && (
              <div class="grid grid-cols-2 gap-2 mb-5">
                {recentPosts.map((post) => (
                  <a href={`/blog/${post.id}`} class="post-card group">
                    <p class="text-[10px] font-mono text-text-muted mb-1">{formatDate(post.data.date)}</p>
                    <h4 class="text-xs font-heading font-semibold text-text-secondary group-hover:text-text-primary transition-colors leading-snug line-clamp-2">
                      {post.data.title}
                    </h4>
                    <div class="mt-2 flex flex-wrap gap-1">
                      {post.data.tags.slice(0, 2).map((tag: string) => (
                        <span class="text-[9px] font-mono text-text-muted/60 bg-surface rounded-full px-1.5 py-0.5">{tag}</span>
                      ))}
                    </div>
                  </a>
                ))}
              </div>
            )}

            <div class="flex items-center gap-4">
              <a href="/blog" class="text-sm font-mono text-accent hover:text-text-primary transition-colors">
                Enter the archive →
              </a>
              <a href="https://buttondown.com/latentchemistry" target="_blank" rel="noopener noreferrer" class="text-sm font-mono text-text-muted hover:text-text-secondary transition-colors border border-border hover:border-border-hover px-4 py-2 rounded-sm">
                Subscribe
              </a>
            </div>
          </div>

          <!-- Right: ContributionGrid -->
          <div class="flex flex-col gap-2 justify-start">
            <ContributionGrid client:visible />
            <p class="text-[9px] font-mono text-text-muted/40">26 weeks of writing</p>
          </div>
        </div>
      </div>
    </section>

    <!-- ══════════════════════════════
         SECTION 5 — CONNECT
         ══════════════════════════════ -->
    <section
      aria-label="Contact"
      id="contact"
      data-nav-section="connect"
      class="full-page-section"
    >
      <span class="section-number">05</span>

      <div class="relative z-10 mx-auto max-w-5xl w-full px-6 h-full flex flex-col justify-center">
        <p class="text-[10px] font-mono text-accent tracking-[0.2em] uppercase mb-4" data-type-label="05 / Connect"></p>

        <div class="mb-8">
          <DecryptedText
            client:visible
            text="Let's build something useful for science."
            speed={30}
            sequential={true}
            revealDirection="start"
            className="text-3xl sm:text-4xl font-heading font-bold text-text-primary leading-tight"
            encryptedClassName="text-accent/30"
            animateOn="view"
          />
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 flex-1">
          <!-- Contact form -->
          <div class="flex flex-col gap-4">
            <form class="flex flex-col gap-3" action="https://formsubmit.co/tubhyamkt@gmail.com" method="POST">
              <input type="hidden" name="_subject" value="New contact from tubhyam.dev" />
              <input type="hidden" name="_captcha" value="true" />
              <input type="hidden" name="_next" value="https://tubhyam.dev/#connect" />
              <div>
                <label for="contact-name" class="sr-only">Your name</label>
                <input
                  id="contact-name"
                  type="text"
                  name="name"
                  placeholder="Name"
                  required
                  class="contact-input"
                />
              </div>
              <div>
                <label for="contact-email" class="sr-only">Your email</label>
                <input
                  id="contact-email"
                  type="email"
                  name="email"
                  placeholder="Email"
                  required
                  class="contact-input"
                />
              </div>
              <div>
                <label for="contact-message" class="sr-only">Your message</label>
                <textarea
                  id="contact-message"
                  name="message"
                  placeholder="Tell me more..."
                  rows={4}
                  required
                  class="contact-input resize-none"
                ></textarea>
              </div>
              <StarBorder as="button" color="#C9A04A" speed="4s">
                Send Message →
              </StarBorder>
            </form>
          </div>

          <!-- Info column -->
          <div class="flex flex-col gap-5">
            <!-- Availability status terminal -->
            <AvailabilityStatus client:visible />

            <div>
              <p class="text-[10px] font-mono text-text-muted uppercase tracking-wider mb-2">Email</p>
              <a href={`mailto:${SITE.email}`} class="text-sm font-mono text-accent hover:text-text-primary transition-colors">
                {SITE.email}
              </a>
            </div>

            <div>
              <p class="text-[10px] font-mono text-text-muted uppercase tracking-wider mb-1.5">Building</p>
              <div class="flex flex-wrap gap-1.5">
                {["SpectraKit", "Spektron", "ReactorTwin", "VibScope"].map((name) => (
                  <span class="text-[10px] font-mono text-text-muted border border-border rounded-full px-2 py-0.5">
                    {name}
                  </span>
                ))}
              </div>
            </div>

            <!-- Social links -->
            <div class="flex items-center gap-2">
              <a href={SITE.github} target="_blank" rel="noopener noreferrer" aria-label="GitHub" class="social-icon">
                <svg viewBox="0 0 24 24" class="w-[18px] h-[18px]" fill="currentColor">
                  <path d="M12 2C6.477 2 2 6.477 2 12c0 4.42 2.865 8.17 6.839 9.49.5.092.682-.217.682-.482 0-.237-.009-.866-.013-1.7-2.782.604-3.369-1.34-3.369-1.34-.454-1.156-1.11-1.464-1.11-1.464-.908-.62.069-.608.069-.608 1.003.07 1.531 1.03 1.531 1.03.892 1.529 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.11-4.555-4.943 0-1.091.39-1.984 1.029-2.683-.103-.253-.446-1.27.098-2.647 0 0 .84-.269 2.75 1.025A9.578 9.578 0 0112 6.836c.85.004 1.705.115 2.504.337 1.909-1.294 2.747-1.025 2.747-1.025.546 1.377.203 2.394.1 2.647.64.699 1.028 1.592 1.028 2.683 0 3.842-2.339 4.687-4.566 4.935.359.309.678.919.678 1.852 0 1.336-.012 2.415-.012 2.743 0 .267.18.578.688.48C19.138 20.167 22 16.418 22 12c0-5.523-4.477-10-10-10z" />
                </svg>
              </a>
              <a href={SITE.twitter} target="_blank" rel="noopener noreferrer" aria-label="Twitter" class="social-icon">
                <svg viewBox="0 0 24 24" class="w-[18px] h-[18px]" fill="currentColor">
                  <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z" />
                </svg>
              </a>
              <a href={SITE.linkedin} target="_blank" rel="noopener noreferrer" aria-label="LinkedIn" class="social-icon">
                <svg viewBox="0 0 24 24" class="w-[18px] h-[18px]" fill="currentColor">
                  <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z" />
                </svg>
              </a>
            </div>
          </div>
        </div>

        <!-- Embedded footer -->
        <footer class="mt-8 pt-6 border-t border-border flex flex-col sm:flex-row items-center justify-between gap-3">
          <nav class="flex items-center gap-4 text-xs text-text-muted flex-wrap">
            <a href="/projects" class="hover:text-text-secondary transition-colors">Projects</a>
            <a href="/research" class="hover:text-text-secondary transition-colors">Research</a>
            <a href="/blog" class="hover:text-text-secondary transition-colors">Blog</a>
            <a href="/simulations" class="hover:text-text-secondary transition-colors">Simulations</a>
            <a href="/about" class="hover:text-text-secondary transition-colors">About</a>
          </nav>
          <p class="text-xs text-text-muted font-mono">&copy; 2026 Tubhyam Karthikeyan</p>
        </footer>
      </div>
    </section>

  </main><!-- end .full-page-scroller -->
</BaseLayout>

<style>
  /* ── Home-specific nav ── */
  #home-nav {
    animation: fade-up 0.5s ease-out 0.1s both;
  }

  .nav-top-link {
    font-family: var(--font-mono);
    font-size: 12px;
    color: #666;
    text-decoration: none;
    transition: color 0.2s ease;
    display: flex;
    align-items: center;
  }

  .nav-top-link:hover {
    color: var(--color-text-primary);
  }

  /* ── Aurora background ── */
  .aurora-bg {
    position: absolute;
    inset: 0;
    background: radial-gradient(ellipse 80% 50% at 50% -20%, rgba(201,160,74,0.09) 0%, transparent 60%),
                radial-gradient(ellipse 60% 40% at 80% 80%, rgba(201,160,74,0.04) 0%, transparent 50%),
                radial-gradient(ellipse 50% 40% at 10% 60%, rgba(78,205,196,0.05) 0%, transparent 55%);
    pointer-events: none;
    z-index: 0;
  }

  /* ── Social icons ── */
  .social-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 36px;
    height: 36px;
    border-radius: 8px;
    border: 1px solid var(--color-border);
    background: var(--color-bg-secondary);
    color: var(--color-text-muted);
    transition: all 0.2s ease;
    text-decoration: none;
  }

  .social-icon:hover {
    border-color: var(--color-border-hover);
    color: var(--color-text-secondary);
    background: var(--color-surface);
  }

  /* ── Scroll chevron pulse ── */
  .scroll-chevron {
    opacity: 0;
    animation: fade-up 0.5s ease-out 1.4s forwards, chevron-pulse 2s ease-in-out 1.4s infinite;
  }

  @keyframes chevron-pulse {
    0%, 100% { opacity: 0.4; transform: translateX(-50%) translateY(0); }
    50% { opacity: 0.7; transform: translateX(-50%) translateY(4px); }
  }

  /* ── Compact sim cards (S3 Explore) ── */
  .compact-sim-card {
    display: block;
    text-decoration: none;
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: 10px;
    padding: 0.875rem 1rem;
    transition: all 250ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  .compact-sim-card:hover {
    border-color: var(--color-border-hover);
    background: var(--color-surface-hover);
  }

  /* ── Simulation cards ── */
  .sim-card {
    display: block;
    text-decoration: none;
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: 12px;
    padding: 1rem;
    transition: all 250ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  .sim-card:hover {
    border-color: var(--color-border-hover);
    background: var(--color-surface-hover);
  }

  /* ── Blog post cards ── */
  .featured-post-card {
    text-decoration: none;
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: 12px;
    padding: 1.25rem 1.5rem;
    transition: all 250ms ease;
  }

  .featured-post-card:hover {
    border-color: rgba(201,160,74,0.3);
    background: rgba(201,160,74,0.03);
    transform: translateY(-2px);
    box-shadow: 0 8px 32px rgba(201,160,74,0.09);
  }

  .post-card {
    display: block;
    text-decoration: none;
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: 10px;
    padding: 1rem;
    transition: all 250ms ease;
  }

  .post-card:hover {
    border-color: var(--color-border-hover);
    background: var(--color-surface-hover);
    transform: translateY(-1px);
    box-shadow: 0 4px 16px rgba(201,160,74,0.06);
  }

  /* ── Contact form inputs ── */
  .contact-input {
    width: 100%;
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: 0;
    padding: 0.625rem 0.875rem;
    font-size: 0.875rem;
    color: var(--color-text-primary);
    font-family: var(--font-body);
    transition: border-color 0.2s ease;
    outline: none;
  }

  .contact-input::placeholder {
    color: var(--color-text-muted);
  }

  .contact-input:focus {
    border-color: rgba(201,160,74,0.4);
    box-shadow: 0 0 0 3px rgba(201,160,74,0.06);
  }

  @keyframes fade-up {
    from { opacity: 0; transform: translateY(12px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* ── Stats marquee ── */
  .marquee-track {
    display: flex;
    width: max-content;
    height: 100%;
    align-items: center;
    animation: marquee-scroll 50s linear infinite;
    will-change: transform;
  }

  .marquee-content {
    white-space: nowrap;
    font-family: var(--font-mono);
    font-size: 10px;
    letter-spacing: 0.06em;
    padding-right: 0;
    color: var(--color-text-muted);
    opacity: 0.45;
  }

  @keyframes marquee-scroll {
    from { transform: translateX(0); }
    to   { transform: translateX(-50%); }
  }

  @media (prefers-reduced-motion: reduce) {
    .scroll-chevron,
    .aurora-bg,
    [style*="animation"] {
      animation: none !important;
      opacity: 1 !important;
      transform: none !important;
    }
    .marquee-track {
      animation: none;
    }
  }
</style>

<script>
  // Mobile menu toggle
  const trigger = document.getElementById("home-mobile-trigger");
  const menu = document.getElementById("home-mobile-menu");
  const backdrop = document.getElementById("home-mobile-backdrop");

  function toggleMenu() {
    menu?.classList.toggle("hidden");
  }

  trigger?.addEventListener("click", toggleMenu);
  backdrop?.addEventListener("click", toggleMenu);

  // Typing cursor for section labels
  const typeLabel = (el: HTMLElement, text: string) => {
    el.textContent = "";
    let i = 0;
    const tick = () => {
      if (i < text.length) {
        el.textContent = text.slice(0, ++i) + "█";
        setTimeout(tick, 38);
      } else {
        el.textContent = text;
      }
    };
    tick();
  };

  const labelObserver = new IntersectionObserver((entries) => {
    for (const entry of entries) {
      if (entry.isIntersecting) {
        const el   = entry.target as HTMLElement;
        const text = el.dataset.typeLabel ?? "";
        typeLabel(el, text);
        labelObserver.unobserve(el);
      }
    }
  }, { threshold: 0.8 });

  document.querySelectorAll<HTMLElement>("[data-type-label]").forEach((el) => {
    el.textContent = "";
    labelObserver.observe(el);
  });

  // Tab title state
  const defaultTitle = document.title;
  document.addEventListener("visibilitychange", () => {
    document.title = document.hidden ? "come back?" : defaultTitle;
  });
</script>
