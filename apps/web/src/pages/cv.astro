---
import PageLayout from "@layouts/PageLayout.astro";
import TerminalWindow from "@components/ui/TerminalWindow.astro";
import TerminalBreadcrumb from "@components/ui/TerminalBreadcrumb.astro";
import { SITE } from "@lib/constants";

import BlurReveal from "@components/islands/BlurReveal";

const breadcrumbSchema = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    { "@type": "ListItem", "position": 1, "name": "Home", "item": SITE.url },
    { "@type": "ListItem", "position": 2, "name": "CV", "item": `${SITE.url}/cv` },
  ],
};

const education = [
  {
    degree: "B.Tech Chemical Engineering",
    institution: "Institute of Chemical Technology, Mumbai",
    period: "2023 – Present",
    details: "Focus: Computational chemistry, machine learning for spectroscopy",
  },
];

const skills = {
  "Languages": ["Python", "TypeScript", "Rust", "C++", "MATLAB"],
  "ML / DL": ["PyTorch", "JAX", "scikit-learn", "Hugging Face", "CUDA"],
  "Chemistry": ["DFT", "Vibrational Spectroscopy", "Chemometrics", "Molecular Dynamics"],
  "Tools": ["Git", "Docker", "Linux", "LaTeX", "Astro", "React"],
};

const skillColors: Record<string, { accent: string; bg: string; border: string }> = {
  "Languages": { accent: "#A78BFA", bg: "#A78BFA", border: "#A78BFA" },
  "ML / DL": { accent: "#C9A04A", bg: "#C9A04A", border: "#C9A04A" },
  "Chemistry": { accent: "#4ECDC4", bg: "#4ECDC4", border: "#4ECDC4" },
  "Tools": { accent: "#34D399", bg: "#34D399", border: "#34D399" },
};

const projects = [
  {
    name: "Spektron",
    role: "Lead Developer",
    description: "Hybrid Mamba-Transformer foundation model for vibrational spectroscopy with VIB disentanglement and MoE routing.",
    href: "/projects/spektron",
  },
  {
    name: "SpectraKit",
    role: "Creator & Maintainer",
    description: "Published Python library for spectral preprocessing — baseline correction, smoothing, normalization, peak analysis. 619 tests, PyPI v1.7.1.",
    href: "/projects/spectrakit",
  },
  {
    name: "ReactorTwin",
    role: "Lead Developer",
    description: "Surrogate digital twin for chemical reactors using Neural ODEs and PINNs.",
    href: "/projects/reactor-twin",
  },
];

const projectColors = ["#A78BFA", "#4ECDC4", "#C9A04A"];
---

<PageLayout title="CV" description="Curriculum vitae — education, skills, projects, and contact. Computational chemistry and ML research at ICT Mumbai.">
  <script type="application/ld+json" set:html={JSON.stringify(breadcrumbSchema)} />
  <section class="py-12">
    <TerminalBreadcrumb segments={[{ label: "cv" }]} />

    <div class="flex items-start justify-between gap-4 flex-wrap">
      <div>
        <BlurReveal
          client:idle
          text="Curriculum Vitae"
          className="text-3xl font-heading font-medium text-text-primary mb-2 tracking-tight"
          as="h1"
        />
        <p
          class="text-text-muted"
          style="opacity: 0; animation: fade-up 0.5s ease-out 0.4s forwards;"
        >
          {SITE.author} — Computational Chemist & ML Researcher
        </p>
      </div>
    </div>

    <div class="mt-12 space-y-8">
      <!-- Education -->
      <TerminalWindow title="education" status="academic">
        <div class="space-y-1.5">
          <div class="flex">
            <span class="w-6 text-right mr-3 select-none flex-shrink-0 text-[#333]">1</span>
            <span class="text-[#34D399]">$</span>
            <span class="ml-2 text-text-secondary">cat education.log</span>
          </div>
          <div class="flex">
            <span class="w-6 text-right mr-3 select-none flex-shrink-0 text-[#333]">2</span>
            <span class="text-text-secondary">&nbsp;</span>
          </div>
          {education.map((edu, i) => (
            <>
              <div class="flex">
                <span class="w-6 text-right mr-3 select-none flex-shrink-0 text-[#333]">{3 + i * 4}</span>
                <span class="text-text-primary font-medium">{edu.degree}</span>
              </div>
              <div class="flex">
                <span class="w-6 text-right mr-3 select-none flex-shrink-0 text-[#333]">{4 + i * 4}</span>
                <span class="text-text-muted">{edu.institution}</span>
              </div>
              <div class="flex">
                <span class="w-6 text-right mr-3 select-none flex-shrink-0 text-[#333]">{5 + i * 4}</span>
                <span class="text-[#60A5FA]">{edu.period}</span>
              </div>
              {edu.details && (
                <div class="flex">
                  <span class="w-6 text-right mr-3 select-none flex-shrink-0 text-[#333]">{6 + i * 4}</span>
                  <span class="text-text-muted/60 text-xs">{edu.details}</span>
                </div>
              )}
            </>
          ))}
        </div>
      </TerminalWindow>

      <!-- Skills -->
      <TerminalWindow title="skills" status="loaded">
        <div class="space-y-4">
          {(() => {
            let lineNum = 1;
            return Object.entries(skills).map(([category, items]) => {
              const colors = skillColors[category] || { accent: "#A78BFA", bg: "#A78BFA", border: "#A78BFA" };
              const catSlug = category.toLowerCase().replace(/[\s\/]+/g, "-");
              const cmdLine = lineNum;
              const outputLine = lineNum + 1;
              lineNum += 3;
              return (
                <div>
                  <div class="flex">
                    <span class="w-6 text-right mr-3 select-none flex-shrink-0 text-[#333]">{cmdLine}</span>
                    <span style={`color: ${colors.accent}`}>$</span>
                    <span class="ml-2 text-text-secondary">cat skills/{catSlug}</span>
                  </div>
                  <div class="flex mt-1.5 flex-wrap">
                    <span class="w-6 text-right mr-3 select-none flex-shrink-0 text-[#333]">{outputLine}</span>
                    <div class="flex flex-wrap gap-1.5">
                      {items.map((item) => (
                        <span
                          class="inline-flex items-center px-2 py-0.5 text-xs rounded-md"
                          style={`background: ${colors.bg}10; color: ${colors.accent}; border: 1px solid ${colors.border}30;`}
                        >
                          {item}
                        </span>
                      ))}
                    </div>
                  </div>
                </div>
              );
            });
          })()}
        </div>
      </TerminalWindow>

      <!-- Selected Projects -->
      <TerminalWindow title="projects" status="~/work">
        <div class="space-y-1.5">
          <div class="flex">
            <span class="w-6 text-right mr-3 select-none flex-shrink-0 text-[#333]">1</span>
            <span class="text-[#34D399]">$</span>
            <span class="ml-2 text-text-secondary">ls -la projects/</span>
          </div>
          <div class="flex">
            <span class="w-6 text-right mr-3 select-none flex-shrink-0 text-[#333]">2</span>
            <span class="text-text-secondary">&nbsp;</span>
          </div>
          {projects.map((proj, i) => {
            const color = projectColors[i % projectColors.length];
            const base = 3 + i * 4;
            return (
              <>
                <div class="flex">
                  <span class="w-6 text-right mr-3 select-none flex-shrink-0 text-[#333]">{base}</span>
                  <a href={proj.href} class="hover:underline font-medium" style={`color: ${color}`}>
                    {proj.name}
                  </a>
                </div>
                <div class="flex">
                  <span class="w-6 text-right mr-3 select-none flex-shrink-0 text-[#333]">{base + 1}</span>
                  <span class="text-text-muted text-xs">{proj.role}</span>
                </div>
                <div class="flex">
                  <span class="w-6 text-right mr-3 select-none flex-shrink-0 text-[#333]">{base + 2}</span>
                  <span class="text-text-secondary">{proj.description}</span>
                </div>
                <div class="flex">
                  <span class="w-6 text-right mr-3 select-none flex-shrink-0 text-[#333]">{base + 3}</span>
                  <span class="text-text-secondary">&nbsp;</span>
                </div>
              </>
            );
          })}
        </div>
      </TerminalWindow>

      <!-- Contact -->
      <TerminalWindow title="contact" status="links" statusColor="#60A5FA">
        <div class="space-y-1.5">
          <div class="flex">
            <span class="w-6 text-right mr-3 select-none flex-shrink-0 text-[#333]">1</span>
            <span class="text-[#34D399]">$</span>
            <span class="ml-2 text-text-secondary">cat ~/.contact</span>
          </div>
          <div class="flex">
            <span class="w-6 text-right mr-3 select-none flex-shrink-0 text-[#333]">2</span>
            <span class="text-text-secondary">&nbsp;</span>
          </div>
          <div class="flex">
            <span class="w-6 text-right mr-3 select-none flex-shrink-0 text-[#333]">3</span>
            <span class="text-text-muted">email</span>
            <span class="text-text-muted/40 mx-2">=</span>
            <a href={`mailto:${SITE.email}`} class="text-[#C9A04A] hover:underline">{SITE.email}</a>
          </div>
          <div class="flex">
            <span class="w-6 text-right mr-3 select-none flex-shrink-0 text-[#333]">4</span>
            <span class="text-text-muted">github</span>
            <span class="text-text-muted/40 mx-2">=</span>
            <a href={SITE.github} target="_blank" rel="noopener noreferrer" class="text-[#34D399] hover:underline">{SITE.github}</a>
          </div>
          <div class="flex">
            <span class="w-6 text-right mr-3 select-none flex-shrink-0 text-[#333]">5</span>
            <span class="text-text-muted">linkedin</span>
            <span class="text-text-muted/40 mx-2">=</span>
            <a href={SITE.linkedin} target="_blank" rel="noopener noreferrer" class="text-[#A78BFA] hover:underline">{SITE.linkedin}</a>
          </div>
        </div>
      </TerminalWindow>
    </div>
  </section>
</PageLayout>
